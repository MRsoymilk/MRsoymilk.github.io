

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ascii 字符画 [ Soymilk ]</title>
  
<link rel="shortcut icon" href="/favicon/favicon.ico">

<link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.min.css">



<link rel="stylesheet" href="/lib/fontawesome/css/all.min.css">



<link rel="stylesheet" id="highlight-link" href="/lib/highlight/style/railscasts.css">



<link rel="stylesheet" href="/css/milk.css">


<link rel="stylesheet" id="shceme-link" href="/css/theme/default.css">


<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div class="milk">
    <div class="milk-header">
       

  <nav class="header-nav">
     
    <div class="nav-menu">
      
        <div id="Home" class="menu-item">
          <i class="fas fa-home" aria-hidden="true"></i>
          <a href="/ ">Home</a>
        </div>
      
        <div id="Archives" class="menu-item">
          <i class="fas fa-archive" aria-hidden="true"></i>
          <a href="/archives ">Archives</a>
        </div>
      
        <div id="About" class="menu-item">
          <i class="fas fa-user-circle" aria-hidden="true"></i>
          <a href="/about ">About</a>
        </div>
      
    </div>
    
    
      <div class="nav-date">
        <div id="date-ymd"></div>
        <div id="date-week"></div>
        <div id="date-time"></div>
      </div>
    
    
    
      <div class="nav-system" id="nav-system"></div>
    
    
    <div class="nav-layout" id="nav-layout" data-layout="tile">
      <div id="layout-show">
        <div class="show-icon"></div>
        <div class="show-text"></div>
      </div>
    </div>
    
    <div class="nav-access">
      <i class="fas fa-toggle-off" id="nav-access"></i>
      <div class="dropdown-content" id="dropdown-content">
        <ul class="social">
          
            <li>
              <a target="_blank" rel="noopener" href="https://github.com/MRsoymilk">
                <i class="fab fa-github-alt" aria-hidden="true"></i>
              </a>
            </li>
          
            <li>
              <a href="mailto:codermrsoymilk@gmail.com">
                <i class="fas fa-envelope" aria-hidden="true"></i>
              </a>
            </li>
          
        </ul>
        <ul>
          <li><span>Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a></span></li>
        </ul>
        <div>
          <label for="scheme-select">Color scheme: </label>
          <select id="scheme-select">
            <option value='default'>default</option>
          </select>
          <label for="highlight-select">Code highlight: </label>
          <select id="highlight-select">
            <option value='railscasts'>railscasts</option>
          </select>
        </div>
        <div>
          <label for="ffolders-select">ffolders scheme: </label>
          <select name="size" id="size-select">
            <option value='medium'>medium</option>
          </select>
          <select name="color" id="color-select">
            <option value='pink'>pink</option>
          </select>
        </div>
        <div>
          <label for="blur-slider">background blur
            <span id="blur-value">10</span> px
          </label>
          <input type="range" id="blur-slider" min="0" max="20" data-value='10'>
        </div>
        <div>
          <label for="font-enable">font</label>
          <input type="checkbox" id="font-check" name="font-check" data-check="fun.ttf">
        </div>
      </div>
    </div>
  </nav>
 
    </div>
    <div class="milk-body">
      
<div class="draggable-toc">
  <div class="toc-title">ascii 字符画</div>
  <p>process: <span>0</span></p>
  <div class="progress-container">
    <div class="progress-bar" id="bar"></div>
  </div>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E9%A2%91-ascii"><span class="toc-text">视频 ascii</span></a></li></ol>
</div>

<div class="post-content" id="post-content">
  <div id="top">ascii 字符画</div>
  <div class="post">
    
    <div class="content-categories">
      
      <i class="fas fa-location-arrow"></i>
      <ul>
        <li>categories</li>
        
          <li>&gt;</li>
          <li>
            <a href="/categories/others/">
          others
        </a>
          </li>
      
      </ul>
    
    </div>
    <hr>
    
    <p><a target="_blank" rel="noopener" href="https://www.asciiart.eu/image-to-ascii">https://www.asciiart.eu/image-to-ascii</a></p>
<p>原理：</p>
<p>先将图像转为灰度图像，灰度图像通常使用 8 位表示，每个像素可以有 256 个不同的灰度值，范围从 0 到 255。其中：</p>
<ul>
<li>0 表示黑色</li>
<li>255 表示白色</li>
<li>0 到 255 之间的值表示不同的灰度级别（如 128 为中灰色）。</li>
</ul>
<p>将这些像素映射为对应字符，字符集长度越大，表示的层次越丰富（也要根据字符的稀疏对应，比如<code>&#39;</code>表示的颜色比<code>$</code>浅）</p>
<span id="more"></span>

<pre><code class="python">ASCII_CHARS = [&#39;`&#39;, &#39;^&#39;, &#39;&quot;&#39;, &#39;,&#39;, &#39;:&#39;, &#39;;&#39;, &#39;I&#39;, &#39;l&#39;, &#39;!&#39;, &#39;i&#39;, &#39;~&#39;, &#39;+&#39;, &#39;_&#39;, &#39;-&#39;, &#39;?&#39;, &#39;]&#39;, &#39;[&#39;, &#39;&#125;&#39;, &#39;&#123;&#39;, &#39;1&#39;, &#39;)&#39;, &#39;(&#39;, &#39;|&#39;, &#39;\\&#39;, &#39;/&#39;, &#39;*&#39;, &#39;j&#39;, &#39;t&#39;, &#39;f&#39;, &#39;r&#39;, &#39;x&#39;, &#39;n&#39;, &#39;v&#39;, &#39;c&#39;, &#39;z&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;U&#39;, &#39;J&#39;, &#39;C&#39;, &#39;L&#39;, &#39;Q&#39;, &#39;0&#39;, &#39;O&#39;, &#39;Z&#39;, &#39;m&#39;, &#39;w&#39;, &#39;q&#39;, &#39;p&#39;, &#39;d&#39;, &#39;b&#39;, &#39;k&#39;, &#39;h&#39;, &#39;)&#39;, &#39;W&#39;, &#39;M&#39;, &#39;B&#39;, &#39;8&#39;, &#39;$&#39;, &#39;%&#39;, &#39;&amp;&#39;, &#39;@&#39;, &#39;#&#39;]
</code></pre>
<p>当字符集有限的情况下，需要按比例划分灰度值，将一个范围的灰度映射为对应的字符</p>
<pre><code class="python">chars = ASCII_CHARS[pixel * len(ASCII_CHARS) // 256]
</code></pre>
<p>现有原图：</p>
<p><img src="/can.png" alt="can"></p>
<p>转换为 ascii 字符后：</p>
<p><img src="/ascii_can.png" alt="ascii can"></p>
<p>emm…，好像不是特别美观</p>
<details>
    <summary>完整代码</summary>

<pre><code class="python">from PIL import Image

# 定义要使用的字符集，字符集长度越大，表示层次越丰富
ASCII_CHARS = [&#39;`&#39;, &#39;^&#39;, &#39;&quot;&#39;, &#39;,&#39;, &#39;:&#39;, &#39;;&#39;, &#39;I&#39;, &#39;l&#39;, &#39;!&#39;, &#39;i&#39;, &#39;~&#39;, &#39;+&#39;, &#39;_&#39;, &#39;-&#39;, &#39;?&#39;, &#39;]&#39;, &#39;[&#39;, &#39;&#125;&#39;, &#39;&#123;&#39;, &#39;1&#39;, &#39;)&#39;, &#39;(&#39;, &#39;|&#39;, &#39;\\&#39;, &#39;/&#39;, &#39;*&#39;, &#39;j&#39;, &#39;t&#39;, &#39;f&#39;, &#39;r&#39;, &#39;x&#39;, &#39;n&#39;, &#39;v&#39;, &#39;c&#39;, &#39;z&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;U&#39;, &#39;J&#39;, &#39;C&#39;, &#39;L&#39;, &#39;Q&#39;, &#39;0&#39;, &#39;O&#39;, &#39;Z&#39;, &#39;m&#39;, &#39;w&#39;, &#39;q&#39;, &#39;p&#39;, &#39;d&#39;, &#39;b&#39;, &#39;k&#39;, &#39;h&#39;, &#39;)&#39;, &#39;W&#39;, &#39;M&#39;, &#39;B&#39;, &#39;8&#39;, &#39;$&#39;, &#39;%&#39;, &#39;&amp;&#39;, &#39;@&#39;, &#39;#&#39;]
print(ASCII_CHARS)
print(len(ASCII_CHARS))

# 调整图像大小
def resize_image(image, new_width=100):
    width, height = image.size
    ratio = height / width
    # 0.55 矫正宽高比
    new_height = int(ratio * new_width * 0.55)
    return image.resize((new_width, new_height))

# 将图像转为灰度
def grayify(image):
    return image.convert(&quot;L&quot;)

# 将像素值映射到ASCII字符
def pixels_to_ascii(image):
    pixels = image.getdata()
    ascii_str = &quot;&quot;.join([ASCII_CHARS[pixel * len(ASCII_CHARS) // 256] for pixel in pixels])
    return ascii_str

# 主函数，执行图像到ASCII的转换
def image_to_ascii(image_path, new_width=100):
    # 打开图像并处理
    try:
        image = Image.open(image_path)
    except Exception as e:
        print(f&quot;无法打开图像文件: &#123;e&#125;&quot;)
        return

    # 调整图像大小和灰度
    image = resize_image(image, new_width)
    image = grayify(image)

    # 转换为ASCII字符
    ascii_str = pixels_to_ascii(image)

    # 将ASCII字符串按宽度分行
    img_width = image.width
    ascii_str_len = len(ascii_str)
    ascii_img = &quot;\n&quot;.join([ascii_str[i:i + img_width] for i in range(0, ascii_str_len, img_width)])

    # 输出或保存ASCII图像
    print(ascii_img)

    # 可以选择将ASCII字符输出到文件中
    with open(&quot;ascii_image.txt&quot;, &quot;w&quot;) as f:
        f.write(ascii_img)

# 调整宽度参数来控制ASCII图像的分辨率
image_to_ascii(&quot;can.png&quot;, 600)
</code></pre>
</details>

<h2 id="视频-ascii"><a href="#视频-ascii" class="headerlink" title="视频 ascii"></a>视频 ascii</h2><p>对视频的处理就是对每一帧进行处理</p>
<pre><code class="python">reader = imageio.get_reader(&#39;bad_apple.mp4&#39;)
for frame in reader:
    # 将帧转换为灰度 ASCII 并显示
    image = Image.fromarray(frame)
    ascii_img = image_to_ascii(image, new_width=80)
</code></pre>
<p>为了符合原始视频帧率，需要额外计算延时（粗略计算）</p>
<pre><code class="python">fps = reader.get_meta_data()[&#39;fps&#39;]
frame_delay = 1.0 / fps  # 每帧显示的时间间隔（秒）

for frame in reader:
    start = time.time()

    end = time.time()
    # 等待适当的时间来同步帧
    time.sleep(frame_delay - (end - start))
</code></pre>
<p>由于使用<code>curses</code>控制，需要额外注意宽度：</p>
<pre><code class="python">ascii_img = image_to_ascii(image, new_width=200)
</code></pre>
<details>
    <summary>完整代码</summary>

<pre><code class="python">import curses
import imageio
import time
from PIL import Image

# 定义要使用的字符集
ASCII_CHARS = [&#39;`&#39;, &#39;^&#39;, &#39;&quot;&#39;, &#39;,&#39;, &#39;:&#39;, &#39;;&#39;, &#39;I&#39;, &#39;l&#39;, &#39;!&#39;, &#39;i&#39;, &#39;~&#39;, &#39;+&#39;, &#39;_&#39;, &#39;-&#39;, &#39;?&#39;, &#39;]&#39;, &#39;[&#39;, &#39;&#125;&#39;, &#39;&#123;&#39;, &#39;1&#39;, &#39;)&#39;, &#39;(&#39;, &#39;|&#39;, &#39;\\&#39;, &#39;/&#39;, &#39;*&#39;, &#39;j&#39;, &#39;t&#39;, &#39;f&#39;, &#39;r&#39;, &#39;x&#39;, &#39;n&#39;, &#39;v&#39;, &#39;c&#39;, &#39;z&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;U&#39;, &#39;J&#39;, &#39;C&#39;, &#39;L&#39;, &#39;Q&#39;, &#39;0&#39;, &#39;O&#39;, &#39;Z&#39;, &#39;m&#39;, &#39;w&#39;, &#39;q&#39;, &#39;p&#39;, &#39;d&#39;, &#39;b&#39;, &#39;k&#39;, &#39;h&#39;, &#39;)&#39;, &#39;W&#39;, &#39;M&#39;, &#39;B&#39;, &#39;8&#39;, &#39;$&#39;, &#39;%&#39;, &#39;&amp;&#39;, &#39;@&#39;, &#39;#&#39;]

# 调整图像大小
def resize_image(image, new_width=100):
    width, height = image.size
    ratio = height / width
    new_height = int(ratio * new_width * 0.55)
    return image.resize((new_width, new_height))

# 将图像转为灰度
def grayify(image):
    return image.convert(&quot;L&quot;)

# 将像素值映射到ASCII字符
def pixels_to_ascii(image):
    pixels = image.getdata()
    ascii_str = &quot;&quot;.join([ASCII_CHARS[pixel * len(ASCII_CHARS) // 256] for pixel in pixels])
    return ascii_str

# 主函数，执行图像到ASCII的转换
def image_to_ascii(image, new_width=100):
    image = resize_image(image, new_width)
    image = grayify(image)
    ascii_str = pixels_to_ascii(image)
    img_width = image.width
    ascii_str_len = len(ascii_str)
    ascii_img = &quot;\n&quot;.join([ascii_str[i:i + img_width] for i in range(0, ascii_str_len, img_width)])
    return ascii_img

def main(stdscr):
    curses.curs_set(0)  # 隐藏光标
    stdscr.nodelay(True)  # 使得 getch() 非阻塞
    stdscr.clear()

    # 打开视频文件
    reader = imageio.get_reader(&#39;bad_apple.mp4&#39;)
    fps = reader.get_meta_data()[&#39;fps&#39;]
    frame_delay = 1.0 / fps  # 每帧显示的时间间隔（秒）

    for frame in reader:
        start = time.time()

        # 将帧转换为灰度 ASCII 并显示
        image = Image.fromarray(frame)
        ascii_img = image_to_ascii(image, new_width=80)
        # 绘制 ASCII 图像
        stdscr.clear()
        for y, line in enumerate(ascii_img.split(&quot;\n&quot;)):
            stdscr.addstr(y, 0, line)
        stdscr.refresh()

        end = time.time()
        # 等待适当的时间来同步帧
        time.sleep(frame_delay - (end - start))

        # 按 &#39;q&#39; 键退出
        if stdscr.getch() == ord(&#39;q&#39;):
            break

# 运行 curses 主程序
if __name__ == &quot;__main__&quot;:
    try:
        curses.wrapper(main)
    except Exception as e:
        print(f&quot;发生错误: &#123;e&#125;&quot;)
</code></pre>
</details>

<p><img src="/output.gif" alt="output"></p>

    
    <hr>
    <div class="content-tags">
      
      <i class="fas fa-tags"></i>
      <ul>
        
        <li><a href="/tags/others/">
          others
        </a></li>
      
      </ul>
    
    </div>
    
     
<div class="comment-tabs" id="comment-tabs">
  comment:
  <ul>
    
      <li><a href="#Valine">Valine</a></li>
    
    
      <li><a href="#LiveRe">LiveRe</a></li>
    
    
      <li><a href="#ChangYan">ChangYan</a></li>
    
  </ul>
  
  
    <div id="ChangYan">
      <!--PC和WAP自适应版-->
      <div id="SOHUCS" ></div> 
      <script type="text/javascript"> 
      (function(){ 
      var appid = 'cyuGH4lBk'; 
      var conf = 'ae32d85e4ca99348209aedfd3ae01478'; 
      var width = window.innerWidth || document.documentElement.clientWidth; 
      if (width < 960) {
      var head = document.getElementsByTagName('head')[0]||document.head||document.documentElement;
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.charset = 'utf-8';
      script.id = 'changyan_mobile_js';
      script.src = 'https://cy-cdn.kuaizhan.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf;
      head.appendChild(script);
      } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://cy-cdn.kuaizhan.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); 
      </script>
    </div>
   
  
  
    <div id="LiveRe">
      
        <!-- LiveRe City install code -->
        <div id="lv-container" data-id="city" data-uid="MTAyMC80NjA4MS8yMjU5Mg==">
          <script type="text/javascript">
            (function(d, s) {
              var j, e = d.getElementsByTagName(s)[0];
              if (typeof LivereTower === 'function') { return; }
              j = d.createElement(s);
              j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
              j.async = true;
              e.parentNode.insertBefore(j, e);
            })(document, 'script');
          </script>
          <noscript>Please activate JavaScript for write a comment in LiveRe</noscript>
          </div>
          <!-- completed City install code -->
        
    </div>
  
  
  
    <div id="Valine">
      <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
      <div id="vcomments"></div>
      <script>
        new Valine({
          el: '#vcomments',
          appId: '5bHFwYPW2iHWCiV7WmNRSenk-gzGzoHsz',
          appKey: '2q4UgVDTmeJf9Phe8VbnNKyC',
          avatar: 'monsterid',
          enableQQ: true
        })
      </script>
    </div>
   
</div>

  </div>
</div>
 
<div>
  <div
    id="sprite-container"
    data-mouse-out-ani='/2top/out_1.png'
    data-mouse-hover-ani='/2top/hover_1.png,/2top/hover_2.png'
    data-mouse-click-ani='/2top/click_1.png,/2top/click_2.png,/2top/click_3.png'
    >
    <canvas id="sprite-canvas" width="100" height="100"></canvas>
  </div>
</div>
    </div>
  </div>
</body>



    
<script src="/lib/jquery/jquery.min.js"></script>


    
<script src="/lib/jquery/jquery-ui.min.js"></script>


    
<script src="/lib/fancybox/jquery.fancybox.min.js"></script>


    
<script src="/lib/highlight/highlight.min.js"></script>


    
<script src="/js/milk.js"></script>



</html>
